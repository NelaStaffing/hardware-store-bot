{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nelav\\\\OneDrive\\\\Desktop\\\\Code Projects\\\\hardware Store Bot\\\\frontend\\\\src\\\\components\\\\ChatBubble.js\";\nimport React from 'react';\n\n// Basic markdown to HTML (bold, italic, line breaks, lists)\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction formatMarkdown(text) {\n  if (!text) return '';\n  let html = text.replace(/\\*\\*(.*?)\\*\\*/g, '<b>$1</b>') // bold\n  .replace(/\\*(.*?)\\*/g, '<i>$1</i>') // italic\n  .replace(/\\n/g, '<br />') // line breaks\n  .replace(/\\r/g, '').replace(/\\n\\s*\\d+\\./g, '<br /><b>$&</b>') // numbered list\n  .replace(/\\n\\s*-/g, '<br />•'); // bullet list\n  return html;\n}\nexport default function ChatBubble({\n  message\n}) {\n  const isAgent = message.sender === 'agent';\n\n  // Try to extract a JSON product_list block from the message\n  let text = message.text || '';\n  let productList = null,\n    intro = '',\n    outro = '';\n  if (isAgent) {\n    // More robust regex: matches JSON block anywhere, even at end\n    const match = text.match(/({[\\s\\S]*?\"type\"\\s*:\\s*\"product_list\"[\\s\\S]*?})/m);\n    console.log('isAgent:', isAgent, 'message:', message);\n    console.log('Matched JSON:', match && match[1]);\n    if (match) {\n      try {\n        // Try normal parse\n        productList = JSON.parse(match[1]);\n        console.log('Parsed productList:', productList);\n      } catch (e1) {\n        // Try to unescape and parse again (for double-encoded JSON)\n        try {\n          const unescaped = match[1].replace(/\\\\\"/g, '\"');\n          productList = JSON.parse(unescaped);\n          console.log('Parsed productList after unescape:', productList);\n        } catch (e2) {\n          productList = null;\n          console.error('JSON parse error:', e1, e2);\n        }\n      }\n      intro = text.slice(0, match.index).trim();\n      outro = text.slice(match.index + match[1].length).trim();\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: isAgent ? 'row' : 'row-reverse',\n      alignItems: 'flex-end',\n      gap: 12\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: isAgent ? '#f3f4f6' : '#d1eaff',\n        color: '#222',\n        borderRadius: 14,\n        padding: '10px 16px',\n        maxWidth: 480,\n        fontSize: 16,\n        boxShadow: isAgent ? '0 1px 4px #0001' : '0 2px 8px #6cf2',\n        wordBreak: 'break-word',\n        whiteSpace: 'pre-line'\n      },\n      children: [isAgent && productList ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [intro && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: 10\n          },\n          dangerouslySetInnerHTML: {\n            __html: formatMarkdown(intro)\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 12,\n            margin: '12px 0'\n          },\n          children: productList.products.map((p, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: '#fff',\n              borderRadius: 10,\n              boxShadow: '0 1px 4px #0001',\n              padding: 12,\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontWeight: 600,\n                fontSize: 16\n              },\n              children: p.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#388e3c',\n                fontWeight: 500\n              },\n              children: [\"$\", p.price]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#888',\n                fontSize: 13\n              },\n              children: [\"SKU: \", p.SKU]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 19\n            }, this), p.aisle && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#1976d2',\n                fontSize: 13\n              },\n              children: [\"Aisle: \", p.aisle]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 31\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this), outro && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 10\n          },\n          dangerouslySetInnerHTML: {\n            __html: formatMarkdown(outro)\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true) : isAgent ? /*#__PURE__*/_jsxDEV(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: formatMarkdown(text)\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this) : text, /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: 11,\n          color: '#888',\n          marginTop: 4,\n          textAlign: isAgent ? 'left' : 'right'\n        },\n        children: message.timestamp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n_c = ChatBubble;\nvar _c;\n$RefreshReg$(_c, \"ChatBubble\");","map":{"version":3,"names":["React","jsxDEV","_jsxDEV","Fragment","_Fragment","formatMarkdown","text","html","replace","ChatBubble","message","isAgent","sender","productList","intro","outro","match","console","log","JSON","parse","e1","unescaped","e2","error","slice","index","trim","length","style","display","flexDirection","alignItems","gap","children","background","color","borderRadius","padding","maxWidth","fontSize","boxShadow","wordBreak","whiteSpace","marginBottom","dangerouslySetInnerHTML","__html","fileName","_jsxFileName","lineNumber","columnNumber","margin","products","map","p","i","fontWeight","name","price","SKU","aisle","marginTop","textAlign","timestamp","_c","$RefreshReg$"],"sources":["C:/Users/nelav/OneDrive/Desktop/Code Projects/hardware Store Bot/frontend/src/components/ChatBubble.js"],"sourcesContent":["import React from 'react';\n\n// Basic markdown to HTML (bold, italic, line breaks, lists)\nfunction formatMarkdown(text) {\n  if (!text) return '';\n  let html = text\n    .replace(/\\*\\*(.*?)\\*\\*/g, '<b>$1</b>') // bold\n    .replace(/\\*(.*?)\\*/g, '<i>$1</i>') // italic\n    .replace(/\\n/g, '<br />') // line breaks\n    .replace(/\\r/g, '')\n    .replace(/\\n\\s*\\d+\\./g, '<br /><b>$&</b>') // numbered list\n    .replace(/\\n\\s*-/g, '<br />•'); // bullet list\n  return html;\n}\n\nexport default function ChatBubble({ message }) {\n  const isAgent = message.sender === 'agent';\n\n  // Try to extract a JSON product_list block from the message\n  let text = message.text || '';\n  let productList = null, intro = '', outro = '';\n  if (isAgent) {\n    // More robust regex: matches JSON block anywhere, even at end\n    const match = text.match(/({[\\s\\S]*?\"type\"\\s*:\\s*\"product_list\"[\\s\\S]*?})/m);\n    console.log('isAgent:', isAgent, 'message:', message);\n    console.log('Matched JSON:', match && match[1]);\n    if (match) {\n      try {\n        // Try normal parse\n        productList = JSON.parse(match[1]);\n        console.log('Parsed productList:', productList);\n      } catch (e1) {\n        // Try to unescape and parse again (for double-encoded JSON)\n        try {\n          const unescaped = match[1].replace(/\\\\\"/g, '\"');\n          productList = JSON.parse(unescaped);\n          console.log('Parsed productList after unescape:', productList);\n        } catch (e2) {\n          productList = null;\n          console.error('JSON parse error:', e1, e2);\n        }\n      }\n      intro = text.slice(0, match.index).trim();\n      outro = text.slice(match.index + match[1].length).trim();\n    }\n  }\n\n  return (\n    <div style={{ display: 'flex', flexDirection: isAgent ? 'row' : 'row-reverse', alignItems: 'flex-end', gap: 12 }}>\n      <div style={{\n        background: isAgent ? '#f3f4f6' : '#d1eaff',\n        color: '#222',\n        borderRadius: 14,\n        padding: '10px 16px',\n        maxWidth: 480,\n        fontSize: 16,\n        boxShadow: isAgent ? '0 1px 4px #0001' : '0 2px 8px #6cf2',\n        wordBreak: 'break-word',\n        whiteSpace: 'pre-line',\n      }}>\n        {isAgent && productList ? (\n          <>\n            {intro && <div style={{ marginBottom: 10 }} dangerouslySetInnerHTML={{ __html: formatMarkdown(intro) }} />}\n            <div style={{ display: 'flex', flexDirection: 'column', gap: 12, margin: '12px 0' }}>\n              {productList.products.map((p, i) => (\n                <div key={i} style={{ background: '#fff', borderRadius: 10, boxShadow: '0 1px 4px #0001', padding: 12, display: 'flex', flexDirection: 'column', gap: 4 }}>\n                  <div style={{ fontWeight: 600, fontSize: 16 }}>{p.name}</div>\n                  <div style={{ color: '#388e3c', fontWeight: 500 }}>${p.price}</div>\n                  <div style={{ color: '#888', fontSize: 13 }}>SKU: {p.SKU}</div>\n                  {p.aisle && <div style={{ color: '#1976d2', fontSize: 13 }}>Aisle: {p.aisle}</div>}\n                </div>\n              ))}\n            </div>\n            {outro && <div style={{ marginTop: 10 }} dangerouslySetInnerHTML={{ __html: formatMarkdown(outro) }} />}\n          </>\n        ) : isAgent ? (\n          <span dangerouslySetInnerHTML={{ __html: formatMarkdown(text) }} />\n        ) : (\n          text\n        )}\n        <div style={{ fontSize: 11, color: '#888', marginTop: 4, textAlign: isAgent ? 'left' : 'right' }}>{message.timestamp}</div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}